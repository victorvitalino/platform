= simple_form_for [:portal, @agenda, @schedule] do |f|
  .row
    .col-md-6
      %h5= @agenda.title
  .row
    .col-md-3
      = f.label :cpf, class: 'fg-label'
      = f.input :cpf, label: false, prompt: 'selecione...'
    .col-md-3
      = f.label :date_schedule,  as: 'string', class: 'fg-label'
      = f.input :date_schedule, as: 'string', label: false,  input_html: { id: 'date', class: 'datepicker' , placeholder: '00/00/0000'}
    .col-md-3
      = f.label :hour_schedule, class: 'fg-label'
      = f.input :hour_schedule,  label: false,  as: 'select', prompt: 'Selecione a data...', input_html: { id: 'hour'}
  %br/
  .row
    .col-md-12
      = f.button :submit, class: 'btn btn-success'




= javascript_tag do
  $(document).ready(function(){
  $('.datepicker').datepicker({
  format: "dd/mm/yyyy",
  language: "pt-BR",
  autoclose: true,
  - if @agenda.weekend
    daysOfWeekDisabled: "0,7",
  - else
    daysOfWeekDisabled: "0,6",
  startDate: "#{"#{(@agenda.start).strftime('%d/%m/%Y')}"}",
  endDate: "#{"#{(@agenda.end).strftime('%d/%m/%Y')}"}",
  });


  $('#date').on('change', function() {
  $('#hour').html('
  %option> Carregando...
  ');
  $.getJSON( "#{portal_agenda_hour_path(agenda_id: @agenda)}?date=" + $(this).val(), function(data) {
  var html = ""
  if(data.length > 0) {
  $.each(data, function(key, value) {
  html += "
  %option{:value => "\"+value+\""}> "+value+"
  ";
  });
  } else {
  html = "
  %option{:value => ""}> Não existem horários para este dia
  "
  }
  $('#hour').html(html);
  });
  })
  });
